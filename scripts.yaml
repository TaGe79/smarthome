kitchen_shutter_set_position:
  alias: Konyha Pozicionalas
  sequence:
   - service_template: |-
       {% if states.input_number.kitchen_shutter_state.state < states.input_number.kitchen_shutter_current_pos.state %}
         switch.turn_off
       {% else %}  
         switch.turn_on
       {% endif %}
     data:
       entity_id: switch.ro2_l_r2_1
   - service_template: |-
       {% if states.input_number.kitchen_shutter_state.state < states.input_number.kitchen_shutter_current_pos.state %}
         switch.turn_on
       {% else %}
         switch.turn_off
       {% endif %}
     data:
       entity_id: switch.ro2_f_r2_3  
   - service: timer.start
     entity_id: timer.kitchen_shutter
     data_template:
       duration: "00:00:{{ states.input_number.kitchen_shutter_delay.state | int }}"
   - service: input_number.set_value
     data_template:
       entity_id: input_number.kitchen_shutter_current_pos
       value: "{{ states.input_number.kitchen_shutter_state.state }}"

kitchen_shutter_stop:
  alias: Konyha Stop
  sequence:
   - service: switch.turn_off
     data:
       entity_id: switch.ro2_l_r2_1
   - service: switch.turn_off
     data:
       entity_id: switch.ro2_f_r2_3

kitchen_shutter_up:
  alias: Konyha Fel
  sequence:
   - service: switch.turn_off
     data:
       entity_id: switch.ro2_l_r2_1
   - service: switch.turn_on
     data:
       entity_id: switch.ro2_f_r2_3
#   - service: input_number.set_value
#     data_template:
#       entity_id: input_number.kitchen_shutter_delay
#       value: |-
#         {{ states.input_number.kitchen_shutter_current_pos.state | int * 0.4 // 1 + 1 }}
#   - service: timer.start
#     entity_id: timer.kitchen_shutter
#     data_template:
#       duration: "00:00:{{ states.input_number.kitchen_shutter_delay.state | int }}"

kitchen_shutter_down:
  alias: Konyha Le
  sequence:
   - service: switch.turn_off
     data:
       entity_id: switch.ro2_f_r2_3
   - service: switch.turn_on
     data:
       entity_id: switch.ro2_l_r2_1
#   - service: input_number.set_value
#     data_template:
#       entity_id: input_number.kitchen_shutter_delay
#       value: |-
#         {{ (100 - states.input_number.kitchen_shutter_current_pos.state | int) * 0.4 // 1 + 1 }}
#   - service: timer.start
#     entity_id: timer.kitchen_shutter
#     data_template:
#       duration: "00:00:{{ states.input_number.kitchen_shutter_delay.state | int }}"
            
livingroom_shutter_set_position:
  alias: Nappali Pozicionalas
  sequence:
   - service_template: |-
       {% if states.input_number.livingroom_shutter_state.state < states.input_number.livingroom_shutter_current_pos.state %}
         switch.turn_off
       {% else %}  
         switch.turn_on
       {% endif %}
     data:
       entity_id: switch.ro1_l_r2_2
   - service_template: |-
       {% if states.input_number.livingroom_shutter_state.state < states.input_number.livingroom_shutter_current_pos.state %}
         switch.turn_on
       {% else %}
         switch.turn_off
       {% endif %}
     data:
       entity_id: switch.ro1_f_r2_4  
   - service: timer.start
     entity_id: timer.livingroom_shutter
     data_template:
       duration: "00:00:{{ states.input_number.livingroom_shutter_delay.state | int }}"
   - service: input_number.set_value
     data_template:
       entity_id: input_number.livingroom_shutter_current_pos
       value: "{{ states.input_number.livingroom_shutter_state.state }}"

kitchen_shutter_close:
  alias: Konyhai redőny lezár
  sequence:
    - condition: state
      entity_id: input_boolean.kitchen_shutter_on
      state: 'on'
    - service: input_number.value_set
      data:
        entity_id: input_number.kitchen_shutter_state
        value: 100
    - service: script.turn_on
      entity_id: script.kitchen_shutter_set_position

livingroom_shutter_close:
  alias: Nappli redőny lezár
  sequence:
    - condition: state
      entity_id: input_boolean.livingroom_shutter_on
      state: 'on'
    - service: input_number.value_set
      data:
        entity_id: input_number.livingroom_shutter_state
        value: 100
    - service: script.turn_on
      entity_id: script.livingroom_shutter_set_position

livingroom_shutter_up:
  alias: Nappali Fel
  sequence:
   - service: switch.turn_off
     data:
       entity_id: switch.ro1_l_r2_2
   - service: switch.turn_on
     data:
       entity_id: switch.ro1_f_r2_4
livingroom_shutter_stop:
  alias: Nappali Stop
  sequence:
   - service: switch.turn_off
     data:
       entity_id: switch.ro1_l_r2_2
   - service: switch.turn_off
     data:
       entity_id: switch.ro1_f_r2_4
livingroom_shutter_down:
  alias: Nappali Le
  sequence:
   - service: switch.turn_off
     data:
       entity_id: switch.ro1_f_r2_4
   - service: switch.turn_on
     data:
       entity_id: switch.ro1_l_r2_2  
     
